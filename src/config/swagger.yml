openapi: "3.0.2"
info:
  title: Lo-Fi Radio
  description: OpenApi Docs
  version: "0.0.1"
  contact:
    name: Jorge Junior
    email: jorgelnjunior@gmail.com
    url: https://github.com/JorgeLNJunior
  license:
    name: MIT
    url: https://github.com/JorgeLNJunior/lofi-radio-api/blob/master/LICENSE.md
servers:
  - url: http://localhost:3000
    description: servidor local - desenvolvimento

paths:
  /artists:
    get:
      summary: Retorna artistas
      description: Returna uma lista com no máximo 20 artistas criados. Não retorna
        artistas que não tiveram sua foto enviada. Querys ainda não disponíveis.
      tags:
        - "Artistas"
      responses:
        "200":
          description: OK
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/artists-response"

    post:
      summary: Registra um novo artista
      description: Registra um novo artista e retorna seus dados.
      tags:
        - "Artistas"
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: "#/components/schemas/artist-register-body"
      responses:
        "201":
          description: OK
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/artist-register-response"
        "400":
          description: Bad request
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/bad-request-error"

  /artists/{uuid}/photo:
    post:
      summary: Upload de foto
      description: Realiza o upload da foto do artista. Após enviado o artista terá
        a propriedade "isHidden" definida como "false", então poderá ser encontrado
        na rota GET.
      tags:
        - "Artistas"
      parameters:
        - name: uuid
          in: path
          required: true
          schema:
            type: string
            example: 062b0499-2eaa-4066-8739-10a0f953b8e7
      requestBody:
        content:
          multipart/form-data:
            schema:
              $ref: "#/components/schemas/artist-photo-upload-body"
      responses:
        "200":
          description: OK
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/artist-photo-upload-response"

  /songs:
    get:
      summary: Retorna músicas
      description: Returna uma lista com 20 músicas criadas. Não retorna
        músicas que não tiveram seu arquivo de aúdio e capa enviados.
        Querys ainda não disponíveis.
      tags:
        - "Músicas"
      responses:
        '200':
          description: OK
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/songs-response"

    post:
      summary: Registra uma nova música
      description: Registra uma nova música e retorna seus dados
      tags:
        - "Músicas"
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: "#/components/schemas/song-register-body"
      responses:
        '200':
          description: OK
          content:
            application/json:
              schema:
                $ref:  "#/components/schemas/artist-register-response"
        '400':
          description: Bad Request
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/bad-request-error"

  /songs/{uuid}/upload:
    post:
      tags:
        - "Músicas"
      summary: Upload dos arquivos da música
      description: Realiza o upload do arquivo de aúdio e capa do album/música.
        Após enviada a música terá a propriedade "isHidden" definida como "false",
        então poderá ser encontrada na rota GET.
      parameters:
        - name: uuid
          in: path
          required: true
          schema:
            type: string
            example: 062b0499-2eaa-4066-8739-10a0f953b8e7
      requestBody:
        content:
          multipart/form-data:
            schema:
              $ref: "#/components/schemas/song-upload-body"
      responses:
        '200':
          description: OK
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/songs-register-response"

  /playlists:
    get:
      tags:
        - "Playlists"
      responses:
        '200':
          description: OK
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/playlists-response"

    post:
      tags:
        - "Playlists"
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref:  "#/components/schemas/playlist-register-body"
      responses:
        '200':
          description: OK
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/playlist-register-response"
        '400':
          description: Bad Request
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/bad-request-error"

components:
  schemas:
    artists-response:
      type: object
      properties:
        status:
          type: integer
          example: 200
        artists:
          type: array
          items:
            type: object
            properties:
              uuid:
                type: string
                example: 062b0499-2eaa-4066-8739-10a0f953b8e7
              name:
                type: string
                example: Kudasaibeats
              spotifyUrl:
                type: string
                example: https://open.spotify.com/artist/3VcaBezSFVJHqylrhaYun2
              youtubeUrl:
                type: string
                example: https://www.youtube.com/channel/UCumJMf6sc_oiLpIElQWUiOQ
              soundcloudUrl:
                type: string
                example: https://soundcloud.com/kudasaibeats
              isHidden:
                type: boolean
                default: false
              createdAt:
                type: string
                example: 2021-02-10T20:34:19.000Z
              updatedAt:
                type: string
                example: 2021-02-10T20:34:19.000Z

    artist-register-response:
      type: object
      properties:
        artist:
          type: object
          properties:
            status:
              type: number
              default: 200
            artist:
              type: object
              properties:
                uuid:
                  type: string
                  example: 062b0499-2eaa-4066-8739-10a0f953b8e7
                name:
                  type: string
                  example: Kudasaibeats
                spotifyUrl:
                  type: string
                  example: https://open.spotify.com/artist/3VcaBezSFVJHqylrhaYun2
                youtubeUrl:
                  type: string
                  example: https://www.youtube.com/channel/UCumJMf6sc_oiLpIElQWUiOQ
                soundcloudUrl:
                  type: string
                  example: https://soundcloud.com/kudasaibeats
                isHidden:
                  type: boolean
                  default: true
                createdAt:
                  type: string
                  example: 2021-02-10T20:34:19.000Z
                updatedAt:
                  type: string
                  example: 2021-02-10T20:34:19.000Z

    artist-register-body:
      type: object
      required:
        - name
      properties:
        name:
          type: string
          example: Kudasaibeats
          description: Nome do artista. Deve ser único.
        spotifyUrl:
          type: string
          example: https://open.spotify.com/artist/3VcaBezSFVJHqylrhaYun2
          description: Link direto para a página do artista no Spotify.
            A URL deve iniciar com "http://" ou "https://", "www" não é obrigatório.
            Também deve seguir o padrão de URL do Spotify (open.spotify.com/artist/).
        youtubeUrl:
          type: string
          example: https://www.youtube.com/channel/UCumJMf6sc_oiLpIElQWUiOQ
          description: Link direto para o canal no YouTube do artista.
            A URL deve iniciar com "http://" ou "https://", "www" não é obrigatório.
            Também deve seguir o padrão de URL do YouTube (youtube.com/channel/).
        soundcloudUrl:
          type: string
          example: https://soundcloud.com/kudasaibeats
          description: Link direto para a página do artista no SoundCloud.
            A URL deve iniciar com "http://" ou "https://", "www" não é obrigatório.
            Também deve seguir o padrão de URL do SoundCloud (soundcloud.com/).

    artist-photo-upload-body:
      type: object
      properties:
        photo:
          type: string
          format: binary

    artist-photo-upload-response:
      type: object
      properties:
        artist:
          type: object
          properties:
            status:
              type: number
              default: 200
            artist:
              type: object
              properties:
                uuid:
                  type: string
                  example: 062b0499-2eaa-4066-8739-10a0f953b8e7
                name:
                  type: string
                  example: Kudasaibeats
                spotifyUrl:
                  type: string
                  example: https://open.spotify.com/artist/3VcaBezSFVJHqylrhaYun2
                youtubeUrl:
                  type: string
                  example: https://www.youtube.com/channel/UCumJMf6sc_oiLpIElQWUiOQ
                soundcloudUrl:
                  type: string
                  example: https://soundcloud.com/kudasaibeats
                photoUrl:
                  type: string
                  example: http://localhost:3000/1612990275474.png
                isHidden:
                  type: boolean
                  default: false
                createdAt:
                  type: string
                  example: 2021-02-10T20:34:19.000Z
                updatedAt:
                  type: string
                  example: 2021-02-10T20:34:19.000Z

    songs-response:
      type: object
      properties:
        status:
          type: number
          default: 200
        songs:
          type: array
          items:
            type: object
            properties:
              uuid:
                type: string
                example: 202e4853-0fba-449c-8529-6518a68eaa40
              title:
                type: string
                example: call me
              songUrl:
                type: string
                example: https://lofiradio.blob.core.windows.net/files/songs/audio/1613485744855.mp3
              coverUrl:
                type: string
                example: https://lofiradio.blob.core.windows.net/files/songs/covers/1613485748199.jpg
              isHidden:
                type: boolean
                default: true
              createdAt:
                type: string
                example: 2021-02-10T20:34:19.000Z
              updatedAt:
                type: string
                example: 2021-02-10T20:34:19.000Z
              artists:
                type: array
                items:
                  type: object
                  properties:
                    uuid:
                      type: string
                      example: 062b0499-2eaa-4066-8739-10a0f953b8e7
                    name:
                      type: string
                      example: 90sFlav
                    spotifyUrl:
                      type: string
                      example: https://open.spotify.com/artist/6OOxsmeDk34xk6Ok3Ap95C
                    youtubeUrl:
                      type: string
                      example: https://www.youtube.com/channel/UC5E_qyrsVIkAmvVzGUae3OA
                    soundcloudUrl:
                      type: string
                      example: https://soundcloud.com/90sflav
                    photoUrl:
                      type: string
                      example: https://lofiradio.blob.core.windows.net/files/artists/photos/1613485748199.jpg
                    createdAt:
                      type: string
                      example: 2021-02-10T20:34:19.000Z
                    updatedAt:
                      type: string
                      example: 2021-02-10T20:34:19.000Z

    song-register-body:
      required:
        - title
        - artistsUuids
      type: object
      properties:
        title:
          type: string
          example: call me
        artistsUuids:
          type: array
          items:
            type: string
            example: 062b0499-2eaa-4066-8739-10a0f953b8e7

    songs-register-response:
      type: object
      properties:
        status:
          type: number
          default: 200
        song:
          type: object
          properties:
            uuid:
              type: string
              example: 202e4853-0fba-449c-8529-6518a68eaa40
            title:
              type: string
              example: call me
            songUrl:
              type: string
              example: https://lofiradio.blob.core.windows.net/files/songs/audio/1613485744855.mp3
            coverUrl:
              type: string
              example: https://lofiradio.blob.core.windows.net/files/songs/covers/1613485748199.jpg
            isHidden:
              type: boolean
              default: true
            createdAt:
              type: string
              example: 2021-02-10T20:34:19.000Z
            updatedAt:
              type: string
              example: 2021-02-10T20:34:19.000Z
            artists:
              type: array
              items:
                type: object
                properties:
                  uuid:
                    type: string
                    example: 062b0499-2eaa-4066-8739-10a0f953b8e7
                  name:
                    type: string
                    example: 90sFlav
                  spotifyUrl:
                    type: string
                    example: https://open.spotify.com/artist/6OOxsmeDk34xk6Ok3Ap95C
                  youtubeUrl:
                    type: string
                    example: https://www.youtube.com/channel/UC5E_qyrsVIkAmvVzGUae3OA
                  soundcloudUrl:
                    type: string
                    example: https://soundcloud.com/90sflav
                  photoUrl:
                    type: string
                    example: https://lofiradio.blob.core.windows.net/files/artists/photos/1613485748199.jpg
                  createdAt:
                    type: string
                    example: 2021-02-10T20:34:19.000Z
                  updatedAt:
                    type: string
                    example: 2021-02-10T20:34:19.000Z

    song-upload-body:
      required:
        - song
        - cover
      type: object
      properties:
        song:
          type: string
          format: binary
        cover:
          type: string
          format: binary

    playlists-response:
      type: object
      properties:
        status:
          type: integer
          default: 200
        playlists:
          type: array
          items:
            type: object
            properties:
              uuid:
                type: string
                example: 062b0499-2eaa-4066-8739-10a0f953b8e7
              title:
                type: string
                example: 1 am study session
              originalUrl:
                type: string
                example: http://www.youtube.com/UC5E_qyrsVIkAmvVzGUae3OA
              createdAt:
                type: string
                example: 2021-02-10T20:34:19.000Z
              updatedAt:
                type: string
                example: 2021-02-10T20:34:19.000Z
              songs:
                type: array
                items:
                  type: object
                  properties:
                    uuid:
                      type: string
                      example: 202e4853-0fba-449c-8529-6518a68eaa40
                    title:
                      type: string
                      example: call me
                    songUrl:
                      type: string
                      example: https://lofiradio.blob.core.windows.net/files/songs/audio/1613485744855.mp3
                    coverUrl:
                      type: string
                      example: https://lofiradio.blob.core.windows.net/files/songs/covers/1613485748199.jpg
                    createdAt:
                      type: string
                      example: 2021-02-10T20:34:19.000Z
                    updatedAt:
                      type: string
                      example: 2021-02-10T20:34:19.000Z
                    artists:
                      type: array
                      items:
                        type: object
                        properties:
                          uuid:
                            type: string
                            example: 062b0499-2eaa-4066-8739-10a0f953b8e7
                          name:
                            type: string
                            example: 90sFlav
                          spotifyUrl:
                            type: string
                            example: https://open.spotify.com/artist/6OOxsmeDk34xk6Ok3Ap95C
                          youtubeUrl:
                            type: string
                            example: https://www.youtube.com/channel/UC5E_qyrsVIkAmvVzGUae3OA
                          soundcloudUrl:
                            type: string
                            example: https://soundcloud.com/90sflav
                          photoUrl:
                            type: string
                            example: https://lofiradio.blob.core.windows.net/files/artists/photos/1613485748199.jpg
                          createdAt:
                            type: string
                            example: 2021-02-10T20:34:19.000Z
                          updatedAt:
                            type: string
                            example: 2021-02-10T20:34:19.000Z

    playlist-register-body:
      required:
        - title
        - songsUuids
      type: object
      properties:
        title:
          type: string
          example: 1 am study session
        originalUrl:
          type: string
          example: http://www.youtube.com/UC5E_qyrsVIkAmvVzGUae3OA
        songsUuids:
          type: array
          items:
            type: string
            example: 062b0499-2eaa-4066-8739-10a0f953b8e7

    playlist-register-response:
      type: object
      properties:
        uuid:
          type: string
          example: 062b0499-2eaa-4066-8739-10a0f953b8e7
        title:
          type: string
          example: 1 am study session
        originalUrl:
          type: string
          example: http://www.youtube.com/UC5E_qyrsVIkAmvVzGUae3OA
        createdAt:
          type: string
          example: 2021-02-10T20:34:19.000Z
        updatedAt:
          type: string
          example: 2021-02-10T20:34:19.000Z
        songs:
          type: array
          items:
            type: object
            properties:
              uuid:
                type: string
                example: 202e4853-0fba-449c-8529-6518a68eaa40
              title:
                type: string
                example: call me
              songUrl:
                type: string
                example: https://lofiradio.blob.core.windows.net/files/songs/audio/1613485744855.mp3
              coverUrl:
                type: string
                example: https://lofiradio.blob.core.windows.net/files/songs/covers/1613485748199.jpg
              createdAt:
                type: string
                example: 2021-02-10T20:34:19.000Z
              updatedAt:
                type: string
                example: 2021-02-10T20:34:19.000Z
              artists:
                type: array
                items:
                  type: object
                  properties:
                    uuid:
                      type: string
                      example: 062b0499-2eaa-4066-8739-10a0f953b8e7
                    name:
                      type: string
                      example: 90sFlav
                    spotifyUrl:
                      type: string
                      example: https://open.spotify.com/artist/6OOxsmeDk34xk6Ok3Ap95C
                    youtubeUrl:
                      type: string
                      example: https://www.youtube.com/channel/UC5E_qyrsVIkAmvVzGUae3OA
                    soundcloudUrl:
                      type: string
                      example: https://soundcloud.com/90sflav
                    photoUrl:
                      type: string
                      example: https://lofiradio.blob.core.windows.net/files/artists/photos/1613485748199.jpg
                    createdAt:
                      type: string
                      example: 2021-02-10T20:34:19.000Z
                    updatedAt:
                      type: string
                      example: 2021-02-10T20:34:19.000Z

    bad-request-error:
      type: object
      properties:
        status:
          type: number
          default: 400
        message:
          type: string
          example: bad request
        errors:
          type: array
          items:
            type: string
            example: error description

    unauthorized-error:
      type: object
      properties:
        status:
          type: number
          default: 401
        message:
          type: string
          example: unauthorized
        errors:
          type: array
          items:
            type: string
            example: invalid credentials
